<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to predictsr • predictsr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to predictsr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">predictsr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/predictsr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to predictsr</h1>
            
      

      <div class="d-none name"><code>predictsr.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://github.com/Biodiversity-Futures-Lab/predictsr" class="external-link"><code>predictsr</code></a>
package accesses the PREDICTS database (Hudson et al, 2013) from within
R, conveniently as a dataframe. It uses the <a href="https://data.nhm.ac.uk/" class="external-link">Natural History Museum Data Portal</a> to
download the latest versions of the PREDICTS database and some related
metadata.</p>
<p>The <a href="https://www.nhm.ac.uk/our-science/research/projects/predicts/science.html" class="external-link">PREDICTS</a>
database comprises over 4 million measurements of species at sites
across the world. The data are mostly collected from arthropods (mainly
insects), and we cover about 2% of the species known by science. All
major terrestrial plant, animal, and fungal groups are covered. There
have been 2 public releases of PREDICTS data. The first was in <a href="https://data.nhm.ac.uk/dataset/the-2016-release-of-the-predicts-database-v1-1" class="external-link">2016</a>
and the second was in <a href="https://data.nhm.ac.uk/dataset/release-of-data-added-to-the-predicts-database-november-2022" class="external-link">2022</a>;
each consisted of about 3 million and 1 million records, respectively.
We include both, as a single dataset, in this package.</p>
<p>To get started, let’s load in the database into R and poke around. To
do so you will use the <code>GetPredictsData</code> function, which
pulls in the data from the data portal. I’ll repeat the default option
below, but you can take either 2016, 2022, or both as the extracts to
fetch. It reads in both extracts into a single dataframe:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicts</span> <span class="op">&lt;-</span> <span class="fu">predictsr</span><span class="fu">::</span><span class="fu"><a href="../reference/GetPredictsData.html">GetPredictsData</a></span><span class="op">(</span>extract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2022</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">predicts</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    4318808 obs. of  67 variables:</span></span>
<span><span class="co">##  $ Source_ID                              : Factor w/ 708 levels "AD1_2001__Liow",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Reference                              : Factor w/ 605 levels "Aben et al. 2008",..: 250 250 250 250 250 250 250 250 250 250 ...</span></span>
<span><span class="co">##  $ Study_number                           : int  1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Study_name                             : Factor w/ 888 levels "1 Western Ghat",..: 748 748 748 748 748 749 749 749 749 749 ...</span></span>
<span><span class="co">##  $ SS                                     : Factor w/ 993 levels "AD1_2001__Liow 1",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Diversity_metric                       : Factor w/ 15 levels "abundance","biomass",..: 1 1 1 1 1 15 15 15 15 15 ...</span></span>
<span><span class="co">##  $ Diversity_metric_unit                  : Factor w/ 29 levels "effort-corrected individuals",..: 6 6 6 6 6 18 18 18 18 18 ...</span></span>
<span><span class="co">##  $ Diversity_metric_type                  : Factor w/ 3 levels "Abundance","Occurrence",..: 1 1 1 1 1 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Diversity_metric_is_effort_sensitive   : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...</span></span>
<span><span class="co">##  $ Diversity_metric_is_suitable_for_Chao  : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...</span></span>
<span><span class="co">##  $ Sampling_method                        : Factor w/ 73 levels "accoustic encounter transect",..: 64 64 64 64 64 64 64 64 64 64 ...</span></span>
<span><span class="co">##  $ Sampling_effort_unit                   : Factor w/ 29 levels "catch","core",..: 21 21 21 21 21 21 21 21 21 21 ...</span></span>
<span><span class="co">##  $ Study_common_taxon                     : Factor w/ 97 levels "","Acrididae",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Rank_of_study_common_taxon             : Factor w/ 9 levels "","Infraspecies",..: 5 5 5 5 5 5 5 5 5 5 ...</span></span>
<span><span class="co">##  $ Site_number                            : int  1 2 3 4 5 1 2 3 4 5 ...</span></span>
<span><span class="co">##  $ Site_name                              : Factor w/ 33356 levels "0","003_HEM_2",..: 7452 20011 22227 14654 17746 7452 20011 22227 14654 17746 ...</span></span>
<span><span class="co">##  $ Block                                  : Factor w/ 2129 levels "","0","01.07.2007",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ SSS                                    : Factor w/ 50032 levels "AD1_2001__Liow 1 1",..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ SSB                                    : Factor w/ 6098 levels "AD1_2001__Liow 1 ",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ SSBS                                   : Factor w/ 50032 levels "AD1_2001__Liow 1  1",..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ Sample_start_earliest                  : Date, format: "1999-03-03" "1999-02-24" ...</span></span>
<span><span class="co">##  $ Sample_end_latest                      : Date, format: "1999-06-30" "1999-06-24" ...</span></span>
<span><span class="co">##  $ Sample_midpoint                        : Date, format: "1999-05-01" "1999-04-25" ...</span></span>
<span><span class="co">##  $ Sample_date_resolution                 : Factor w/ 3 levels "day","month",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Max_linear_extent_metres               : num  3000 3000 3000 1800 2000 3000 3000 3000 1800 2000 ...</span></span>
<span><span class="co">##  $ Habitat_patch_area_square_metres       : num  870000 5210000 7946000 415000 272000 ...</span></span>
<span><span class="co">##  $ Sampling_effort                        : num  30 30 30 18 20 30 30 30 18 20 ...</span></span>
<span><span class="co">##  $ Rescaled_sampling_effort               : num  1 1 1 0.6 0.667 ...</span></span>
<span><span class="co">##  $ Habitat_as_described                   : Factor w/ 3155 levels "","010 WETLAND",..: 2141 2458 2458 2447 2432 2141 2458 2458 2447 2432 ...</span></span>
<span><span class="co">##  $ Predominant_land_use                   : Factor w/ 10 levels "Primary vegetation",..: 1 4 4 3 3 1 4 4 3 3 ...</span></span>
<span><span class="co">##  $ Source_for_predominant_land_use        : Factor w/ 4 levels "","Direct from publication / author",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Use_intensity                          : Factor w/ 4 levels "Minimal use",..: 4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span><span class="co">##  $ Km_to_nearest_edge_of_habitat          : num  NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ Years_since_fragmentation_or_conversion: num  NA 70 70 30 30 NA 70 70 30 30 ...</span></span>
<span><span class="co">##  $ Transect_details                       : Factor w/ 506 levels "","100m","100m*2&amp;300m*1",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Coordinates_method                     : Factor w/ 2 levels "Direct from publication / author",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Longitude                              : num  104 104 104 104 104 ...</span></span>
<span><span class="co">##  $ Latitude                               : num  1.35 1.35 1.39 1.33 1.28 ...</span></span>
<span><span class="co">##  $ Country_distance_metres                : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ Country                                : Factor w/ 246 levels "Afghanistan",..: 199 199 199 199 199 199 199 199 199 199 ...</span></span>
<span><span class="co">##  $ UN_subregion                           : Factor w/ 23 levels "Australia and New Zealand",..: 17 17 17 17 17 17 17 17 17 17 ...</span></span>
<span><span class="co">##  $ UN_region                              : Factor w/ 6 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Ecoregion_distance_metres              : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ Ecoregion                              : Factor w/ 814 levels "Admiralty Islands Lowland Rain Forests",..: 548 548 548 548 548 548 548 548 548 548 ...</span></span>
<span><span class="co">##  $ Biome                                  : Factor w/ 16 levels "Tundra","Boreal Forests/Taiga",..: 13 13 13 13 13 13 13 13 13 13 ...</span></span>
<span><span class="co">##  $ Realm                                  : Factor w/ 8 levels "Afrotropic","Antarctic",..: 4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span><span class="co">##  $ Hotspot                                : Factor w/ 36 levels "","Atlantic Forest",..: 32 32 32 32 32 32 32 32 32 32 ...</span></span>
<span><span class="co">##  $ Wilderness_area                        : Factor w/ 6 levels "","Amazonia",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Taxon_number                           : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Taxon_name_entered                     : Factor w/ 60997 levels "1","10","100",..: 7029 7029 7029 7029 7029 7029 7029 7029 7029 7029 ...</span></span>
<span><span class="co">##  $ Indication                             : Factor w/ 2134 levels "","???","aardvark",..: 995 995 995 995 995 995 995 995 995 995 ...</span></span>
<span><span class="co">##  $ Parsed_name                            : Factor w/ 48443 levels "","a","A100_Eumenidae",..: 5498 5498 5498 5498 5498 5498 5498 5498 5498 5498 ...</span></span>
<span><span class="co">##  $ Taxon                                  : Factor w/ 29585 levels "","Abacoproeces saltuum",..: 2167 2167 2167 2167 2167 2167 2167 2167 2167 2167 ...</span></span>
<span><span class="co">##  $ COL_ID                                 : int  13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 ...</span></span>
<span><span class="co">##  $ Name_status                            : Factor w/ 3 levels "","accepted name",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Rank                                   : Factor w/ 9 levels "","Infraspecies",..: 5 5 5 5 5 5 5 5 5 5 ...</span></span>
<span><span class="co">##  $ Kingdom                                : Factor w/ 5 levels "","Animalia",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Phylum                                 : Factor w/ 14 levels "","Annelida",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Class                                  : Factor w/ 53 levels "","Actinopterygii",..: 25 25 25 25 25 25 25 25 25 25 ...</span></span>
<span><span class="co">##  $ Order                                  : Factor w/ 291 levels "","Acarosporales",..: 128 128 128 128 128 128 128 128 128 128 ...</span></span>
<span><span class="co">##  $ Family                                 : Factor w/ 1652 levels "","Abrocomidae",..: 98 98 98 98 98 98 98 98 98 98 ...</span></span>
<span><span class="co">##  $ Genus                                  : Factor w/ 10606 levels "","Abacoproeces",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Species                                : Factor w/ 14093 levels "","abalinealis",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Best_guess_binomial                    : Factor w/ 36312 levels "","Abacoproeces saltuum",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Higher_taxon                           : Factor w/ 63 levels "","Actinopterygii",..: 26 26 26 26 26 26 26 26 26 26 ...</span></span>
<span><span class="co">##  $ Measurement                            : num  42 242 232 111 63 5 22 5 9 10 ...</span></span>
<span><span class="co">##  $ Effort_corrected_measurement           : num  42 242 232 185 94.5 5 22 5 9 10 ...</span></span></code></pre>
<p>So we can see that there are over 4 million records in the combined
PREDICTS extracts. Let’s look at a set of summary statistics for the
database:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="va">predicts</span><span class="op">[</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">predicts</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Source_ID"</span>, <span class="st">"Study_name"</span>, <span class="st">"Taxon_name_entered"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span><span class="op">]</span></span>
<span><span class="va">species_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">taxa</span><span class="op">[</span><span class="va">taxa</span><span class="op">$</span><span class="va">Rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Infraspecies"</span><span class="op">)</span>, <span class="st">"Taxon"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">taxa</span><span class="op">[</span><span class="op">!</span><span class="va">taxa</span><span class="op">$</span><span class="va">Rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Infraspecies"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span></span>
<span>  <span class="st">"This database has {length(unique(predicts$SS))} studies across "</span>,</span>
<span>  <span class="st">"{length(unique(predicts$SSBS))} sites, in "</span>,</span>
<span>  <span class="st">"{length(unique(predicts$Country))} countries, and with "</span>,</span>
<span>  <span class="st">"{species_counts} species."</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This database has 817 studies across 35736 sites, in 101 countries, and with 54863 species.</span></span></code></pre>
<p>So over 30,000 sites, 101 countries, and 12,892 species in this
dataframe! There are a couple of important columns that should be noted.
The <code>SS</code> column is what we use to identify studies when
dealing with PREDICTS data. This is the concantenation of the
<code>Source_ID</code>, and the <code>Study_number</code> columns.
Another important identifier is the <code>SBBS</code>, the concatenation
of <code>Source_ID</code>, <code>Study_number</code>, <code>Block</code>
and <code>Site_number</code>, which is what we use to identify single
sites in the database.</p>
<p>Let’s also check the ranges of sample collection in the database:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span></span>
<span>  <span class="st">"Earliest sample collection (midpoint): {min(predicts$Sample_midpoint)}, "</span>,</span>
<span>  <span class="st">"latest sample collection (midpoint): {max(predicts$Sample_midpoint)}"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Earliest sample collection (midpoint): 1984-04-22, latest sample collection (midpoint): 2018-05-01</span></span></code></pre>
<p><strong>NOTE:</strong> maybe a plot here to demonstrate the different
taxonomic coverage? But I’m not sure how to relicate what is out
there…</p>
<div class="section level2">
<h2 id="accessing-site-level-summaries">Accessing site-level summaries<a class="anchor" aria-label="anchor" href="#accessing-site-level-summaries"></a>
</h2>
<p>We also include access to the site-level summaries from the full
release; to get <em>these data</em> you will need to use the
<code>GetSitelevelSummaries</code> function. The function call is very
similar to pull in the summaries for the same data as above:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries</span> <span class="op">&lt;-</span> <span class="fu">predictsr</span><span class="fu">::</span><span class="fu"><a href="../reference/GetSitelevelSummaries.html">GetSitelevelSummaries</a></span><span class="op">(</span>extract <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2022</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">summaries</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    35738 obs. of  50 variables:</span></span>
<span><span class="co">##  $ Source_ID                              : Factor w/ 707 levels "AD1_2001__Liow",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Reference                              : Factor w/ 605 levels "Aben et al. 2008",..: 250 250 250 250 250 250 250 250 250 250 ...</span></span>
<span><span class="co">##  $ Study_number                           : int  1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Study_name                             : Factor w/ 888 levels "1 Western Ghat",..: 748 748 748 748 748 749 749 749 749 749 ...</span></span>
<span><span class="co">##  $ SS                                     : Factor w/ 993 levels "AD1_2001__Liow 1",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Diversity_metric                       : Factor w/ 15 levels "abundance","biomass",..: 1 1 1 1 1 15 15 15 15 15 ...</span></span>
<span><span class="co">##  $ Diversity_metric_unit                  : Factor w/ 29 levels "effort-corrected individuals",..: 6 6 6 6 6 18 18 18 18 18 ...</span></span>
<span><span class="co">##  $ Diversity_metric_type                  : Factor w/ 3 levels "Abundance","Occurrence",..: 1 1 1 1 1 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Diversity_metric_is_effort_sensitive   : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...</span></span>
<span><span class="co">##  $ Diversity_metric_is_suitable_for_Chao  : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...</span></span>
<span><span class="co">##  $ Sampling_method                        : Factor w/ 73 levels "accoustic encounter transect",..: 64 64 64 64 64 64 64 64 64 64 ...</span></span>
<span><span class="co">##  $ Sampling_effort_unit                   : Factor w/ 29 levels "catch","core",..: 21 21 21 21 21 21 21 21 21 21 ...</span></span>
<span><span class="co">##  $ Study_common_taxon                     : Factor w/ 97 levels "","Acrididae",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Rank_of_study_common_taxon             : Factor w/ 9 levels "","Infraspecies",..: 5 5 5 5 5 5 5 5 5 5 ...</span></span>
<span><span class="co">##  $ Site_number                            : int  1 2 3 4 5 1 2 3 4 5 ...</span></span>
<span><span class="co">##  $ Site_name                              : Factor w/ 33601 levels "0","003_HEM_2",..: 7456 20074 22376 14658 17757 7456 20074 22376 14658 17757 ...</span></span>
<span><span class="co">##  $ Block                                  : Factor w/ 2129 levels "","0","01.07.2007",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ SSS                                    : Factor w/ 53008 levels "AD1_2001__Liow 1 1",..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ SSB                                    : Factor w/ 6113 levels "AD1_2001__Liow 1 ",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ SSBS                                   : Factor w/ 53008 levels "AD1_2001__Liow 1  1",..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ Sample_start_earliest                  : Date, format: "1999-03-03" "1999-02-24" ...</span></span>
<span><span class="co">##  $ Sample_end_latest                      : Date, format: "1999-06-30" "1999-06-24" ...</span></span>
<span><span class="co">##  $ Sample_midpoint                        : Date, format: "1999-05-01" "1999-04-25" ...</span></span>
<span><span class="co">##  $ Sample_date_resolution                 : Factor w/ 3 levels "day","month",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Max_linear_extent_metres               : num  3000 3000 3000 1800 2000 3000 3000 3000 1800 2000 ...</span></span>
<span><span class="co">##  $ Habitat_patch_area_square_metres       : num  870000 5210000 7946000 415000 272000 ...</span></span>
<span><span class="co">##  $ Sampling_effort                        : num  30 30 30 18 20 30 30 30 18 20 ...</span></span>
<span><span class="co">##  $ Rescaled_sampling_effort               : num  1 1 1 0.6 0.667 ...</span></span>
<span><span class="co">##  $ Habitat_as_described                   : Factor w/ 3155 levels "","010 WETLAND",..: 2141 2458 2458 2447 2432 2141 2458 2458 2447 2432 ...</span></span>
<span><span class="co">##  $ Predominant_land_use                   : Factor w/ 10 levels "Primary vegetation",..: 1 4 4 3 3 1 4 4 3 3 ...</span></span>
<span><span class="co">##  $ Source_for_predominant_land_use        : Factor w/ 4 levels "","Direct from publication / author",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Use_intensity                          : Factor w/ 4 levels "Minimal use",..: 4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span><span class="co">##  $ Km_to_nearest_edge_of_habitat          : num  NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ Years_since_fragmentation_or_conversion: num  NA 70 70 30 30 NA 70 70 30 30 ...</span></span>
<span><span class="co">##  $ Transect_details                       : Factor w/ 506 levels "","100m","100m*2&amp;300m*1",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Coordinates_method                     : Factor w/ 2 levels "Direct from publication / author",..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ Longitude                              : num  104 104 104 104 104 ...</span></span>
<span><span class="co">##  $ Latitude                               : num  1.35 1.35 1.39 1.33 1.28 ...</span></span>
<span><span class="co">##  $ Country_distance_metres                : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ Country                                : Factor w/ 246 levels "Afghanistan",..: 199 199 199 199 199 199 199 199 199 199 ...</span></span>
<span><span class="co">##  $ UN_subregion                           : Factor w/ 23 levels "Australia and New Zealand",..: 17 17 17 17 17 17 17 17 17 17 ...</span></span>
<span><span class="co">##  $ UN_region                              : Factor w/ 6 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ Ecoregion_distance_metres              : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ Ecoregion                              : Factor w/ 814 levels "Admiralty Islands Lowland Rain Forests",..: 548 548 548 548 548 548 548 548 548 548 ...</span></span>
<span><span class="co">##  $ Biome                                  : Factor w/ 16 levels "Tundra","Boreal Forests/Taiga",..: 13 13 13 13 13 13 13 13 13 13 ...</span></span>
<span><span class="co">##  $ Realm                                  : Factor w/ 8 levels "Afrotropic","Antarctic",..: 4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span><span class="co">##  $ Hotspot                                : Factor w/ 36 levels "","Atlantic Forest",..: 32 32 32 32 32 32 32 32 32 32 ...</span></span>
<span><span class="co">##  $ Wilderness_area                        : Factor w/ 6 levels "","Amazonia",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ N_samples                              : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Higher_taxa                            : chr  "Hymenoptera" "Hymenoptera" "Hymenoptera" "Hymenoptera" ...</span></span></code></pre>
<p>Investigating the summary data closer we see that there are a number
of missing columns between the two dataframes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">predicts</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">predicts</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">summaries</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Taxon_number"                 "Taxon_name_entered"          </span></span>
<span><span class="co">##  [3] "Indication"                   "Parsed_name"                 </span></span>
<span><span class="co">##  [5] "Taxon"                        "COL_ID"                      </span></span>
<span><span class="co">##  [7] "Name_status"                  "Rank"                        </span></span>
<span><span class="co">##  [9] "Kingdom"                      "Phylum"                      </span></span>
<span><span class="co">## [11] "Class"                        "Order"                       </span></span>
<span><span class="co">## [13] "Family"                       "Genus"                       </span></span>
<span><span class="co">## [15] "Species"                      "Best_guess_binomial"         </span></span>
<span><span class="co">## [17] "Higher_taxon"                 "Measurement"                 </span></span>
<span><span class="co">## [19] "Effort_corrected_measurement"</span></span></code></pre>
<p>This is because all of the measurement-level data has been dropped
from the dataframe. Now indeed we could try and replicate the creation
of the <code>summaries</code> dataframe through some {dplyr} operations.
These would be the following (roughly):</p>
<p><strong>Note:</strong> I’m not sure on the summary statistics for
this one, there seems to be some differences, and there are a couple
sites that don’t match up.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries_rep</span> <span class="op">&lt;-</span> <span class="va">predicts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Higher_taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Higher_taxon</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    N_samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Measurement</span><span class="op">)</span>,</span>
<span>    Rescaled_sampling_effort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Rescaled_sampling_effort</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">SSBS</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">summaries</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">SSBS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_copy</span> <span class="op">&lt;-</span> <span class="va">summaries</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">SSBS</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">summaries_rep</span><span class="op">$</span><span class="va">SSBS</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">SSBS</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">summaries_copy</span>, <span class="va">summaries_rep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Attributes: &lt; Component \"row.names\": 35719 string mismatches &gt;"                                                            </span></span>
<span><span class="co">##  [2] "Component \"Source_ID\": Attributes: &lt; Component \"levels\": Lengths (707, 708) differ (string compare on first 707) &gt;"      </span></span>
<span><span class="co">##  [3] "Component \"Study_common_taxon\": 1905 string mismatches"                                                                    </span></span>
<span><span class="co">##  [4] "Component \"Rank_of_study_common_taxon\": 1254 string mismatches"                                                            </span></span>
<span><span class="co">##  [5] "Component \"Site_name\": Attributes: &lt; Component \"levels\": Lengths (33601, 33356) differ (string compare on first 33356) &gt;"</span></span>
<span><span class="co">##  [6] "Component \"Site_name\": Attributes: &lt; Component \"levels\": 27521 string mismatches &gt;"                                      </span></span>
<span><span class="co">##  [7] "Component \"SSS\": Attributes: &lt; Component \"levels\": Lengths (53008, 50032) differ (string compare on first 50032) &gt;"      </span></span>
<span><span class="co">##  [8] "Component \"SSS\": Attributes: &lt; Component \"levels\": 13977 string mismatches &gt;"                                            </span></span>
<span><span class="co">##  [9] "Component \"SSB\": Attributes: &lt; Component \"levels\": Lengths (6113, 6098) differ (string compare on first 6098) &gt;"         </span></span>
<span><span class="co">## [10] "Component \"SSB\": Attributes: &lt; Component \"levels\": 460 string mismatches &gt;"                                              </span></span>
<span><span class="co">## [11] "Component \"SSBS\": Attributes: &lt; Component \"levels\": Lengths (53008, 50032) differ (string compare on first 50032) &gt;"     </span></span>
<span><span class="co">## [12] "Component \"SSBS\": Attributes: &lt; Component \"levels\": 13977 string mismatches &gt;"                                           </span></span>
<span><span class="co">## [13] "Component \"Rescaled_sampling_effort\": Mean relative difference: 0.237503"                                                  </span></span>
<span><span class="co">## [14] "Component \"Higher_taxa\": 8399 string mismatches"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="accessing-descriptions-of-the-columns-in-predicts">Accessing descriptions of the columns in PREDICTS<a class="anchor" aria-label="anchor" href="#accessing-descriptions-of-the-columns-in-predicts"></a>
</h2>
<p>As we’ve seen already, there are 67 (!) columns in the PREDICTS
database, and within the NHM Data portal releases, we have included a
description of the data that is used in each of these columns. You can
access this via the <code>GetColumnDescriptions</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">descriptions</span> <span class="op">&lt;-</span> <span class="fu">predictsr</span><span class="fu">::</span><span class="fu"><a href="../reference/GetColumnDescriptions.html">GetColumnDescriptions</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">descriptions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    69 obs. of  8 variables:</span></span>
<span><span class="co">##  $ Column                          : chr  "Source_ID" "Reference" "Study_number" "Study_name" ...</span></span>
<span><span class="co">##  $ Applies_to                      : chr  "Data Source" "Data Source" "Study" "Study" ...</span></span>
<span><span class="co">##  $ Site_extract                    : chr  "Yes" "Yes" "Yes" "Yes" ...</span></span>
<span><span class="co">##  $ Diversity_extract               : chr  "Yes" "Yes" "Yes" "Yes" ...</span></span>
<span><span class="co">##  $ Type                            : chr  "String" "String" "Integer" "String" ...</span></span>
<span><span class="co">##  $ Value_guaranteed_to_be_non_empty: chr  "Yes" "Yes" "Yes" "Yes" ...</span></span>
<span><span class="co">##  $ Notes                           : chr  "ID for the Data Source." "Reference for the Data Source in the main text." " " " " ...</span></span>
<span><span class="co">##  $ Validation                      : chr  "Unique." " " "Between 1 and n for n Studies within Data Source. Unique within Source_ID." "Unique within Source_ID." ...</span></span></code></pre>
<p>So this includes the <code>Column</code> name, the resolution of the
<code>Column</code> (<code>Applies_to</code>), whether it is in the
PREDICTS extract (<code>Diversity_extract</code>), whether it is in the
site-level summaries (<code>Site_extract</code>), the datatype of the
<code>Column</code>*, whether it is guaranteed to be nonempty, any
additional <code>Notes</code>, and any information on the range of
values that the <code>Column</code> may be expected to take
(<code>Validation</code>).</p>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>The <a href="https://data.nhm.ac.uk/about/download" class="external-link">NHM Data Portal
API</a> has no rate limits so be considerate with your requests. Make
sure you save the data somewhere, or use a tool like <a href="https://docs.ropensci.org/targets/index.html" class="external-link"><code>targets</code></a>
to save you from re-running workflows.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Hudson, Lawrence N., et al. “The PREDICTS database: a global database
of how local terrestrial biodiversity responds to human impacts.”
Ecology and evolution 4.24 (2014): 4701-4735.
&lt;doi.org/10.1002/ece3.1303&gt;.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Connor Duffin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
